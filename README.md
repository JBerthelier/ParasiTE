# ParasiTE

#Aim 
ParasiTE is a pipeline wrote in R and bash that aim to identify TE-related gene and TE-related alternative gene isoforms.

#Steps
ParasiTE is globally composed of three steps:

1)	Discrimination of intragenic and intergenic TEs
2)	Discrimination of intronic and exonic TEs
3)  Classification of TE-derived alternative transcript events. 

#Outputs
ParasiTE give in output:

. Annotation and proportion of intergenic and intragenic TEs.
. Annotation and proportion of intragenic exonic and intragenic intronic TEs.
. List of TE-related gene candidates
. List of TE-related alternative gene isoforms

______________________________________

#Prerequise to run ParasiTE

R (version XXX have been tested)
R packages: optparse , stringr , data.table , dplyr , splitstackshape , tidyr

#Input data

Three input data are required

1) TE annotation in .gff 
2) gene annotation in .gff
3) de novo transcriptome annotation in .gff file generated by Stringtie2 (https://ccb.jhu.edu/software/stringtie/)

_____________________________________

#How to generate a transcriptome annotation for ParasiTE ?

ParasiTE have been build to work with Stringtie2 transcriptome annotation. 
Stringtie2 allows to generate a de novo transcriptome annotation and help to identify potential new isoform that have not been identificate in the reference genome annotation.
It also support short reads (eg. Illumina) or long reads (eg. PacBio or Oxford Nanopore) based genome alignements. 

Here are the basic command lines to generate your transcriptome annotation for ParasiTE:

. For short-reads:

1) Hisat2

hisat2-build genome_assembly.fa index_name
hisat2 -x index_name --dta -1 forward.fq -2 reverse.fq -S short_reads_aln.sam
samtools view -Su short_reads_aln.sam > short_reads_aln.bam 
samtools sort short_reads_aln.bam -o short_reads_aln.sorted.bam

2) Stringtie2


. For long-reads:

1) minimap2

minimap2 -ax splice -uf -k14 -G 10000 genome_assembly.fa long_reads.fa > long_reads_aln.sam
samtools view -Su long_reads_aln.sam > long_reads_aln.bam
samtools sort -@ 10 long_reads_aln.bam > long_reads_aln.sorted.bam

2) Stringtie2

stringtie long_reads_aln.sorted.bam -G reference_genome_annotation.gff3 -L > Stringtie2_transcriptome_annotation.gff3




